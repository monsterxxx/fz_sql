SELECT GROUP_PAYMONTH_SUM.COMPANY,
  DATESERIAL(GROUP_PAYMONTH_SUM.FOR_YEAR, GROUP_PAYMONTH_SUM.FOR_MONTH, 1) AS MONTHDATE,
  GROUP_TRAINER.TRAINER_ID,
  SUM(ROUND(GROUP_TRAINER.PERCENT*GROUP_PAYMONTH_SUM.PAYMENT_SUMMA, 0)) AS SUMM_EARNED
FROM GROUP_PAYMONTH_SUM INNER JOIN GROUP_TRAINER
ON ((GROUP_PAYMONTH_SUM.GROUP_ID = GROUP_TRAINER.GROUP_ID)
    AND (DATESERIAL(GROUP_TRAINER.FROM_YEAR, GROUP_TRAINER.FROM_MONTH,1) <=DATESERIAL(GROUP_PAYMONTH_SUM.FOR_YEAR, GROUP_PAYMONTH_SUM.FOR_MONTH, 1))
    AND (DATESERIAL(GROUP_PAYMONTH_SUM.FOR_YEAR, GROUP_PAYMONTH_SUM.FOR_MONTH, 1)<=(DATESERIAL(IIf(GROUP_TRAINER.TO_YEAR IS NULL, 2099, GROUP_TRAINER.TO_YEAR), IIf(GROUP_TRAINER.TO_MONTH IS NULL, 12, GROUP_TRAINER.TO_MONTH),1))))
GROUP BY GROUP_PAYMONTH_SUM.COMPANY,
  DATESERIAL(GROUP_PAYMONTH_SUM.FOR_YEAR, GROUP_PAYMONTH_SUM.FOR_MONTH, 1),
  GROUP_TRAINER.TRAINER_ID
