SELECT TRAINER_SALARY_EARNED.COMPANY,
  TRAINER_SALARY_EARNED.TRAINER_ID,
  TRAINER.PERSON_ID,
  TRAINER_SALARY_EARNED.MONTHDATE,
  TRAINER_SALARY_EARNED.SUMM_EARNED,
  TRAINER_SALARY_PAID.SUMM_PAID,
  [SUMM_EARNED]-IIf([SUMM_PAID] Is Null,0,[SUMM_PAID]) AS DEBT
FROM (TRAINER_SALARY_EARNED LEFT JOIN TRAINER_SALARY_PAID ON (TRAINER_SALARY_EARNED.COMPANY = TRAINER_SALARY_PAID.COMPANY) AND (TRAINER_SALARY_EARNED.MONTHDATE = TRAINER_SALARY_PAID.MONTHDATE) AND (TRAINER_SALARY_EARNED.TRAINER_ID = TRAINER_SALARY_PAID.TRAINER_ID)) INNER JOIN TRAINER ON TRAINER_SALARY_EARNED.TRAINER_ID = TRAINER.TRAINER_ID
WHERE ((([SUMM_EARNED]-IIf([SUMM_PAID] Is Null,0,[SUMM_PAID]))>0));
