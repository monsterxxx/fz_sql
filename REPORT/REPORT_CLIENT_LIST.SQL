SELECT TIMETABLE.[WEEK_DAY_TYPE_ID],
  GROUPS.FULLNAME,
  GROUPS.HALL_ID,
  SPORT.FULLNAME AS SPORT,
  [person_1].[LASTNAME] & " " & [person_1].[FIRSTNAME] & " " & [person_1].[PATRONYMIC] AS TRAINER,
  TIMETABLE.TIME_START,
  TIMETABLE.TIME_END,
  [person].[LASTNAME] & " " & [person].[FIRSTNAME] AS CLIENT,
  [person].[LASTNAME] & " " & [person].[FIRSTNAME] & " " & [person].[PATRONYMIC] AS CLIENT_FULLNAME,
  [PERSON].[BIRTHDAY], "моб. " & [PERSON].[TEL_MOB] & ", раб. "& [PERSON].[TEL_WORK] & ", др. " & [PERSON].[TEL_OTHER] AS PHONENUMBER,
  IIf(PERSON.TEL_MOB Is Null And PERSON.TEL_WORK Is Null And PERSON.TEL_OTHER Is Null,'!','V') AS HAS_PHONENUMBER,
  IIf(PERSON.HAS_PASS=False,'','V') AS HAS_PASS,
  PERSON.HAS_PASS AS HAS_PASS_TF,
  IIf(PERSON.BIRTHDAY is null,'!',IIf(MONTH(PERSON.BIRTHDAY)=MONTH(CALENDAR.CALENDAR_DATE),DAY(PERSON.BIRTHDAY),'V')) AS HAS_BIRTHDAY,
  IIf(CLIENT_TOTAL_DEBT.DEBT>0,'!','') AS HAS_DEBT,
  CALENDAR.CALENDAR_DATE,
  CALENDAR.[MONTHDATE]
FROM
  (TRAINER
    INNER JOIN (PERSON
      INNER JOIN (((GROUPS INNER JOIN SPORT ON GROUPS.SPORT_ID = SPORT.SPORT_ID) INNER JOIN
        (CLIENT INNER JOIN
          (GROUP_CLIENT LEFT JOIN CLIENT_TOTAL_DEBT ON GROUP_CLIENT.CLIENT_ID = CLIENT_TOTAL_DEBT.CLIENT_ID) ON CLIENT.CLIENT_ID = GROUP_CLIENT.CLIENT_ID)
        ON GROUPS.GROUP_ID = GROUP_CLIENT.GROUP_ID)
          INNER JOIN (TIMETABLE INNER JOIN CALENDAR ON TIMETABLE.[WEEK_DAY_TYPE_ID]=WEEKDAY(CALENDAR.CALENDAR_DATE,2))
          ON GROUPS.GROUP_ID = TIMETABLE.GROUP_ID)
      ON PERSON.PERSON_ID = CLIENT.PERSON_ID)
    ON TRAINER.TRAINER_ID = GROUPS.TRAINER_ID)
  INNER JOIN PERSON AS PERSON_1 ON TRAINER.PERSON_ID = PERSON_1.PERSON_ID
WHERE GROUPS.HIDDEN = FALSE AND GROUP_CLIENT.HIDDEN = FALSE
ORDER BY [person].[LASTNAME] & " " & [person].[FIRSTNAME] & " " & [person].[PATRONYMIC];
