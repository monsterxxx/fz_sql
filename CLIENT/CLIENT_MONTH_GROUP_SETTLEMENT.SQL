(SELECT
CHARGE.CLIENT_ID AS CLIENT_ID,
CHARGE.GROUP_ID AS GROUP_ID,
TRAINING.CREATE_DATE AS CHARGE_OR_PAY_DATE,
YEAR(TRAINING.CREATE_DATE) AS FOR_YEAR,
MONTH(TRAINING.CREATE_DATE) AS FOR_MONTH,
"Начисление" AS DIRECTION,
CHARGE.PRICE AS PRICE,
CHARGE.CHARGE_TYPE_NAME AS CHARGE_TYPE_NAME,
ROUND(CHARGE.CHARGE_TYPE_PERCENT*100,0) AS MONTH_PERCENT,
CHARGE.DISCOUNT_NAME1 AS DISCOUNT_NAME1,
ROUND(CHARGE.DISCOUNT_PERCENT1*100,0) AS DISCOUNT_PERCENT1,
CHARGE.DISCOUNT_NAME2 AS DISCOUNT_NAME2,
ROUND(CHARGE.DISCOUNT_PERCENT2*100,0) AS DISCOUNT_PERCENT2,
CHARGE.TRAINING_ID AS TRAINING_ID,
CHARGE.CREATE_DATE AS CREATE_DATE,
CHARGE.SUMMA AS SUMMA
FROM
CHARGE INNER JOIN TRAINING ON (TRAINING.TRAINING_ID = CHARGE.TRAINING_ID)
)
UNION ALL (SELECT
CLIENT_ID,
GROUP_ID,
PAYMENT.PAYMENT_DATE,
PAYMENT.FOR_YEAR,
PAYMENT.FOR_MONTH,
"Оплата",
Null, Null, Null, Null, Null, Null, Null, Null,
PAYMENT.CREATE_DATE,
PAYMENT.SUMMA
FROM
PAYMENT WHERE (PAYMENT.PAYMENT_TYPE_ID=1)
);
